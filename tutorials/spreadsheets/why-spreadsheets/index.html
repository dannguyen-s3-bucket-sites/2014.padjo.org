<html lang="en" class="no-js">
    <head>
        <title>Why Spreadsheets? | Public Affairs Data Journalism at Stanford University</title>
        <meta name="description" content="A short overview of the importance of spreadsheets">
        <meta http-equiv="content-type" content="text/html" charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge,chrome=1">
        <meta name="author" content="Daniel Nguyen">
        <meta content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width" name="viewport">
        <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <link rel="shortcut icon" href="/images/favicon.ico">
        <link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/images/apple-touch-icon-57x57-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
        <link href="/assets/stylesheets/application.css" rel="stylesheet" type="text/css" /><script src="/assets/javascripts/application.js" type="text/javascript" charset="utf-8"></script>
        <script type="text/javascript" src="//use.typekit.net/deu1taf.js"></script>
        <script>
            try{Typekit.load();}catch(e){}
        </script>
        <script>
            videojs.options.flash.swf = "/assets/misc/video-js.swf";
        </script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            
             ga('create', 'UA-55019978-1', 'auto');
             ga('send', 'pageview');
            
             (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
               e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);})(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');
            
            _st('install','u_zeqrQcz16KLaiR6m3p');
        </script>
    </head>
</html>
<body class="woz scrollspy">
    <header class="woz">
        <nav class="navbar navbar-inverse" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <h2 class="title">
                        <a href="/">Public Affairs Data Journalism at Stanford</a>
                    </h2>
                </div>
                <div></div>
                <div id="st-results-container">
                    <script>
                        var Swiftype = window.Swiftype || {};
                         (function() {
                          Swiftype.key = 'u_zeqrQcz16KLaiR6m3p';
                          Swiftype.inputElement = 'form[action="/search"] input[type="text"]';
                          Swiftype.attachElement = 'form[action="/search"] input[type="text"]';
                          Swiftype.renderStyle = "overlay";
                        
                          /** DO NOT EDIT BELOW THIS LINE **/
                          var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
                          script.src = "//s.swiftypecdn.com/embed.js";
                          var entry = document.getElementsByTagName('script')[0];
                          entry.parentNode.insertBefore(script, entry);
                        }());
                    </script>
                </div>
            </div>
        </nav>
    </header>
    <div id="woz-content"><article class="tutorial">
    <div class="container">
        <section class="top-matter">
            <section class="top-meta">
                <h4 class="crumb">
                    <span><a href="/tutorials">Tutorials</a></span> <span>></span> <span><a class="ref" href="/tutorials#spreadsheets">Spreadsheets</a></span> 
                </h4>
                <h1 class="title">
                    Why Spreadsheets?
                </h1>
                <div class="description">
                    <p>
                        A short overview of the importance of spreadsheets
                    </p>
                    
                </div>
            </section>
        </section>
        <section class="content"><p>As Philip Meyer said in his book, <a href="http://www.amazon.com/Precision-Journalism-Reporters-Introduction-Science/dp/0742510883">Precision Journalism</a>:</p>

<blockquote>
  <p>There are two kinds of databases: those that you create yourself and those that were created by somebody else, usually without your convenience in mind.</p>
</blockquote>

<p>If you want to be one of those independent collectors of data – because you're paying attention to something that the government or society just <em>isn't</em> – then get used to using spreadsheets. Your ability to be smart at organizing information is going to be just as important as passion (if not much more important) when it comes to accomplishing your goal.</p>

<p><a href="http://www.slate.com/articles/news_and_politics/crime/2013/12/newtown_anniversary_what_slate_learned_from_trying_and_failing_to_record.html">Slate's attempt to track gun-related homicides</a> is one such spreadsheet-based do-it-yourself data project. For this quick walkthrough, we're going to track the places we like to eat.</p>

<h3 id="spreadsheets-are-hard">Spreadsheets are hard</h3>

<p>If you find spreadsheets incomprehensible, you're in good company that includes even the warden of Rikers Island, one of the world's largest prisons.</p>

<p>From the New York Times, "<a href="http://www.nytimes.com/2014/09/22/nyregion/report-twisted-data-on-fights-in-a-rikers-jail.html">Report Found Distorted Data on Jail Fights at Rikers Island</a>"</p>

<blockquote>
  <p>When interviewed by correction investigators on May 14, 2012, Mr. Clemons said he rarely reviewed reports on daily inmate fights, according to the audit. Though the data was delivered to him electronically, he said he found the spreadsheets difficult to read on his computer and could not figure out how to print them. He told investigators he had no reason to question the accuracy of the data, in part because he had “noticed fewer alarms over the course of his tenure,” the report said.</p>
</blockquote>

<blockquote>
  <p>Mr. Gumusdere told investigators that he had difficulty understanding the incident reports and rarely reviewed them. He said he delegated this to his subordinates, whom he described as “incompetent,” according to the audit.</p>
</blockquote>

<p>So why spreadsheets? They're not that difficult. And with minimal effort, an otherwise plain list becomes data that can be easily analyzed and extended.</p>

<p>Basically, every non-trivial application has a spreadsheet (or something like a spreadsheet) behind it. Because computers like structured information.</p>

<h3 id="the-importance-of-csv">The importance of CSV</h3>

<p>I asked the class to provide a CSV of their favorite restaurants, in this format:</p>

<pre><code>name,address,city,state,category,yelp_url
Shake Shack,E 23rd St and Madison Ave,Manhattan,NY,Burgers,http://www.yelp.com/biz/shake-shack-new-york-2
Big Gay Ice Cream,125 E 7th St.,Manhattan,NY,Desserts,http://www.yelp.com/biz/big-gay-ice-cream-shop-new-york
Crif Dogs,113 St. Marks Place,Manhattan,NY,Hot dogs,http://www.yelp.com/biz/crif-dogs-new-york
</code></pre>

<p>If I had asked the class to just write up a list of their favorite restaurants, I would've received 20 files (likely in varying formats: Word documents, text files, HTML, etc) with no easy way to combine them, e.g.</p>

<pre><code>In-N-Out Burger on Radford in North Hollywood
Chucky Cheese: 1920 Rodeo Dr., Los Angeles
New York Fried Chicken, in New York, on 62 1st Ave, 10001
</code></pre>

<p>With everyone following the same format, though, I was able to quickly combine all 20 plaintext files and import them into a nice spreadsheet:</p>

<p><img alt="img" src="/files/tutorials/spreadsheets/fav-restaurants-from-csv.png" /></p>

<p>Spreadsheet programs simply know how to turn CSV format (and other <em>delimited</em> text files) into a user-friendly spreadsheet. It doesn't matter that it started out as just plain text.</p>

<h4 id="computer-literacy">Computer literacy</h4>

<p>The main takeaways from manually creating CSV files is that:</p>

<ol>
  <li>CSVs, like most data, are just text</li>
  <li><strong>Computers tend to do exactly as you tell them to</strong>…which in many cases, make them seem quite "dumb."</li>
</ol>

<p>If we tell a spreadsheet program that we're importing a CSV file, i.e <strong>comma-separated values</strong>, then it will expect the data in that text file to be <strong>separated by commas</strong>.</p>

<p>So if your CSV file is a little awry:</p>

<pre><code>name,address,city,state,category
McDonalds,100 Broadway,New York NY,Burgers
Taco Bell,200 Smith St,Building 4,Chicago,IL,Tacos
In-N-Out near 600 Palm Drive in Santa Monica, Burgers
</code></pre>

<p>You're going to get an awry spreadsheet:</p>

<p><img alt="img" src="/files/tutorials/spreadsheets/messed-up-delimiters-csv.png" /></p>

<p>So keep in mind this power of typos and how even a single character can wreck a computer's ability to do analysis.</p>

<h3 id="why-the-yelp-url">Why the Yelp URL</h3>

<p>One of the problems with all kinds of data is knowing when two names refer to the same thing. For example:</p>

<table>
  <thead>
    <tr>
      <th>name</th>
      <th>address</th>
      <th>city</th>
      <th>state</th>
      <th>category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Momofuku</td>
      <td>171 1st Ave</td>
      <td>New York</td>
      <td>NY</td>
      <td>Ramen</td>
    </tr>
    <tr>
      <td>Momofuku Noodle Bar</td>
      <td>171 1st Ave.</td>
      <td>New York</td>
      <td>NY</td>
      <td>Asian Fusion</td>
    </tr>
  </tbody>
</table>

<p>It does appear to be the same restaurant, since the address is the same. But again, remember that a <em>single character</em> will throw off a computer's calculations. In other words, "<code>Ave</code>" is not equal to "<code>Ave.</code>", as far as the computer is concerned, and thus, the computer will consider these two records to refer to two different restaurants.</p>

<p>This is a common problem in data work, hence, the term "dirty data" and the valuable skill of "data cleaning".</p>

<h4 id="a-unique-identifier">A unique identifier</h4>

<p>However, with the Yelp URL, we (kind of) sidestep the issue of needing the names and addresses to be exact. As long as there is just one Yelp entry for both of the Momofuku listings, e.g.</p>

<p><a href="http://www.yelp.com/biz/momofuku-noodle-bar-new-york">http://www.yelp.com/biz/momofuku-noodle-bar-new-york</a></p>

<p>Then we can tell the computer to use that when <em>grouping</em> (e.g. to count up entries for a pivot table) the records and be reasonably confident that it can determine duplciate entries.</p>

<h4 id="extending-the-data">Extending the data</h4>

<p>Another benefit of including the Yelp URL is that we can quickly add useful Yelp data to our class crowdsourced list, such as whether Yelp users liked the restaurants as much as we do, how many Yelp users have patronized the restaurants, and how expensive each restaurant in the eyes of the Yelp userbase.</p>

<p><img alt="img" src="/files/tutorials/spreadsheets/fav-restaurants-with-yelp.png" /></p>

<p>Note: in the class spreadsheet, I've also added a "<code>user_id</code>" field, which is a random number given to each class member, just so we can pivot on that value and evaluate each individual's taste. Keep reading to see the results of that.</p>

<p>Check out the <a href="https://docs.google.com/a/stanford.edu/spreadsheets/d/1KzXP1eij0m2yTFL7kdDm1d1c8pXUr7Ynd_zeiFPwyFA/edit#gid=0">full class spreadsheet here on Google Drive</a>.</p>

<h3 id="pivots">Pivots</h3>

<p>With this restaurant list in a spreadsheet, we can try all kinds of interesting pivots. For example, by grouping rows by <code>user_id</code>, we can then analyze:</p>

<ul>
  <li>With <code>state</code>, the states/countries each of us have lived in or traveled to.</li>
  <li>With <code>yelp_stars</code>, how each of us agreed or differed with the Yelp crowd in terms of taste</li>
  <li>With <code>yelp_priciness</code>, how extravagant each of us are in our favorite restaurants.</li>
</ul>

<p>We could also pivot starting with <code>state</code>, to see total number of favorite places per state, or the average <code>priciness</code> of good places to eat (does New York have higher Yelp priciness ratings compared to Texas)? And so forth.</p>

<p><img alt="img" src="/files/tutorials/spreadsheets/fav-restaurants-pivoted-on-yelp-avg.png" /></p>

<h3 id="mapping">Mapping</h3>

<p>Since we took the time to record the addresses of each place (which we could've derived from the Yelp listing, but I wanted this assignment to include a bit of manual labor), we now have the potential to <strong>map</strong> this data.</p>

<p>There are many ways to geocode and display address data. <strong>Google Fusion Tables</strong> is a convenient service, and as I mentioned earlier, it is basically just a spreadsheet. In fact, we can import our current spreadsheet directly into Fusion Tables.</p>

<p>There is one convention we have to follow, though: Fusion Tables wants a single column against which it can look up geo-coordinates. We currently have three: <code>address</code>, <code>city</code>, <code>state</code>.</p>

<p>This is easily fixed in the spreadsheet by creating a new column (which you can name <code>location</code>) and then filling it with a formula like this:</p>

<pre><code>=CONCATENATE(B2, " ", C2, ", ", D2)
</code></pre>

<p>Which will produce a string like this:</p>

<pre><code>E 23rd St and Madison Ave Manhattan, NY
</code></pre>

<p>I won't cover the details of how to use Fusion Tables, though you can see the <a href="https://www.google.com/fusiontables/DataSource?docid=1i8bF_rM5IPz2mm-O2ZqH4jAyem8H839MzuXloe3G#rows:id=1">results at this link</a>.</p>

<p>Here's what a Fusion Table looks like (again, basically a spreadsheet):</p>

<p><img alt="img" src="/files/tutorials/spreadsheets/fusion-tables-spreadsheet-restaurant.png" /></p>

<p>Here's how Google maps our <code>location</code> field:</p>

<p><img alt="img" src="/files/tutorials/spreadsheets/fusion-tables-map-restaurants.png" /></p>

<h3 id="the-inherent-messiness-of-data">The inherent messiness of data</h3>

<p>Another potentially useful column is <code>category</code>. For example, it'd be interesting to see how many of us like Sushi places versus French places. However, a quick pivot using <code>category</code> as the <strong>Rows</strong> shows it's a little more complicated than that:</p>

<pre><code>American  19
American (New)  2
American Diner  1
American Pub  1
American Steakhouse 1
American(Traditional) 1
</code></pre>

<p>Should all of those be "American"? What about the five things categorized as "Burgers"?</p>

<p>Another categorical quandary:</p>

<table>
  <thead>
    <tr>
      <th>name</th>
      <th>address</th>
      <th>city</th>
      <th>state</th>
      <th>category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Buffalo Wild Wings</td>
      <td>1620 Saratoga Ave</td>
      <td>San Jose</td>
      <td>CA</td>
      <td>American</td>
    </tr>
    <tr>
      <td>Buffalo Wild Wings</td>
      <td>505 E Nifong Blvd</td>
      <td>Columbia</td>
      <td>MO</td>
      <td>Chicken Wings</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>Is Buffalo Wild Wings really just "Chicken Wings", or is it so much more, considering their offerings of chicken sandwiches and "Cheeseburger Slammers"? And maybe "American" is too broad, perhaps it should be considered a "Bar &amp; Grill"?</p>

<p>This is the problem of <strong>taxonomy</strong>, and it's not easily solved other than having a sort of discipline and "style guide" to resolve these ambiguities. One strategy is to just make more columns, such as <code>category</code> and <code>subcategory</code>, though that adds even more work and more ways for people to differ on the exact genre of Buffalo Wild Wings.</p>

<h3 id="spreadsheet-everything">Spreadsheet everything</h3>

<p>While spreadsheets aren't the perfect all-encompassing data tool, getting into the habit of using them to not just store numbers, but lists and notes, will make it much easier to create data that can be analyzed and extended into interesting visualizations and applications.</p>

        </section>
    </div>
</article>
    </div>
</body>
<footer class="woz">
    <div class="container">
        <div class="row">
            <div class="col-sm-6">
                <ul class="list-unstyled">
                    <li>
                        <a href="/lectures/comm_273d/2014_fall/syllabus">Syllabus</a>
                    </li>
                    <li>
                        <a href="/tutorials">Tutorials</a>
                    </li>
                    <li>
                        <a href="/readings">Readings</a>
                    </li>
                    <li>
                        <a href="/datasets">Datasets</a>
                    </li>
                    <li>
                        <a href="https://github.com/public-affairs-data-journalism/padjo">Github</a>
                    </li>
                    <li>
                        <a href="/secret-menu">Secret menu</a>
                    </li>
                </ul>
            </div>
            <div class="col-sm-6">
                <h4>
                    <a href="/">Public Affairs Data Journalism I</a>
                </h4>
                <div>
                    taught by 
                    <div>
                        <a href="http://danwin.com" style="padding-right: 1.0em;">Dan Nguyen</a>
                    </div>
                    <div>
                        at <a href="//journalism.stanford.edu" style="padding-right: 1.0em;"> Stanford Journalism</a>
                    </div>
                    <div>
                        <a href="https://twitter.com/dancow" class="twitter-follow-button" data-show-count="false" data-dnt="true">Follow @dancow</a>
                        <script>
                            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
                        </script>
                    </div>
                    <div>
                        <a href="https://twitter.com/StanfordJourn" class="twitter-follow-button" data-show-count="false" data-dnt="true">Follow @StanfordJourn</a>
                        <script>
                            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
